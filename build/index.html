<!DOCTYPE HTML>
<html>
<head>
  <title>Evil Wood</title>
  <style>body,html{padding:0;margin:0;overflow:hidden}canvas{background-color:#000}#a{width:2px;height:40px;position:fixed;left:50%;margin-left:-1px;top:50%;margin-top:-20px;background-color:rgba(255,255,255,.3)}#b{width:40px;height:2px;position:fixed;left:50%;margin-left:-20px;top:50%;margin-top:-1px;background-color:rgba(255,255,255,.3)}#c{width:100%;position:fixed;top:10%;left:0;text-align:center;color:#fff;font-family:Courier New,monospace;font-size:4vh}</style>
</head>
<body>
  <canvas id="scene"></canvas></div><div id="c"></div>
  <script>!function(){function n(n){return 1/n==-1/0?-1*n:n}function t(){Pn.enable(Pn.DEPTH_TEST)}function e(){Pn.viewport(0,0,_n.width,_n.height),Pn.clear(Pn.COLOR_BUFFER_BIT|Pn.DEPTH_BUFFER_BIT)}function i(){var n=gn.create();gn.set(bn,n),xn.push(n)}function r(){if(0==xn.length)throw"Invalid popMatrix!";bn=xn.pop()}function o(){m(),l(),v(),h()}function a(n,t){var e=Pn.createShader(Pn.FRAGMENT_SHADER);Pn.shaderSource(e,n),Pn.compileShader(e);var i=Pn.createShader(Pn.VERTEX_SHADER);Pn.shaderSource(i,t),Pn.compileShader(i),Pn.attachShader(Sn,i),Pn.attachShader(Sn,e),Pn.linkProgram(Sn),Pn.getProgramParameter(Sn,Pn.LINK_STATUS)||alert("Could not initialize shaders"),Pn.useProgram(Sn),o()}function u(n,t,e){gn.perspective(n,_n.width/_n.height,t,e,En)}function c(){gn.identity(bn)}function f(n,t,e){gn.translate(bn,[n,t,e])}function s(n,t,e,i){gn.rotate(bn,n,[t,e,i])}function g(n,t,e){gn.scale(bn,[n,t,e])}function m(){Sn.vertexPositionAttribute=Pn.getAttribLocation(Sn,"aVertexPosition"),Pn.enableVertexAttribArray(Sn.vertexPositionAttribute),Sn.pMatrixUniform=Pn.getUniformLocation(Sn,"uPMatrix"),Sn.mvMatrixUniform=Pn.getUniformLocation(Sn,"uMVMatrix")}function l(){Sn.textureCoordAttribute=Pn.getAttribLocation(Sn,"aTextureCoord"),Pn.enableVertexAttribArray(Sn.textureCoordAttribute),Sn.samplerUniform=Pn.getUniformLocation(Sn,"uSampler")}function v(){Sn.vertexNormalAttribute=Pn.getAttribLocation(Sn,"aVertexNormal"),Pn.enableVertexAttribArray(Sn.vertexNormalAttribute),Sn.nMatrixUniform=Pn.getUniformLocation(Sn,"uNMatrix")}function h(){Sn.useLightingUniform=Pn.getUniformLocation(Sn,"uUseLighting"),Sn.ambientColorUniform=Pn.getUniformLocation(Sn,"uAmbientColor"),Sn.pointLightingLocationUniform=Pn.getUniformLocation(Sn,"uPointLightingLocation"),Sn.pointLightingColorUniform=Pn.getUniformLocation(Sn,"uPointLightingColor"),Sn.useDistanceLighWeightingUniform=Pn.getUniformLocation(Sn,"uUseDistanceLightWeighting")}function b(n,t){Pn.pixelStorei(Pn.UNPACK_FLIP_Y_WEBGL,!0),Pn.bindTexture(Pn.TEXTURE_2D,n),Pn.texImage2D(Pn.TEXTURE_2D,0,Pn.RGBA,Pn.RGBA,Pn.UNSIGNED_BYTE,t),Pn.texParameteri(Pn.TEXTURE_2D,Pn.TEXTURE_MAG_FILTER,Pn.NEAREST),Pn.texParameteri(Pn.TEXTURE_2D,Pn.TEXTURE_MIN_FILTER,Pn.LINEAR_MIPMAP_NEAREST),Pn.generateMipmap(Pn.TEXTURE_2D),Pn.bindTexture(Pn.TEXTURE_2D,null)}function E(n){var t=Pn.createBuffer();return t.numElements=n.length,Pn.bindBuffer(Pn.ARRAY_BUFFER,t),Pn.bufferData(Pn.ARRAY_BUFFER,new Float32Array(n),Pn.STATIC_DRAW),t}function x(n){var t=Pn.createBuffer();return t.numElements=n.length,Pn.bindBuffer(Pn.ELEMENT_ARRAY_BUFFER,t),Pn.bufferData(Pn.ELEMENT_ARRAY_BUFFER,new Uint16Array(n),Pn.STATIC_DRAW),t}function d(n,t,e){Pn.bindBuffer(Pn.ARRAY_BUFFER,n.position),Pn.vertexAttribPointer(Sn.vertexPositionAttribute,3,Pn.FLOAT,!1,0,0),Pn.bindBuffer(Pn.ARRAY_BUFFER,n.texture),Pn.vertexAttribPointer(Sn.textureCoordAttribute,2,Pn.FLOAT,!1,0,0),Pn.activeTexture(Pn.TEXTURE0),Pn.bindTexture(Pn.TEXTURE_2D,t),Pn.uniform1i(Sn.samplerUniform,0),Pn.uniform1i(Sn.useDistanceLighWeightingUniform,e),Pn.bindBuffer(Pn.ELEMENT_ARRAY_BUFFER,n.index),Pn.bindBuffer(Pn.ARRAY_BUFFER,n.normal),Pn.vertexAttribPointer(Sn.vertexNormalAttribute,3,Pn.FLOAT,!1,0,0)}function p(){Pn.uniformMatrix4fv(Sn.pMatrixUniform,!1,En),Pn.uniformMatrix4fv(Sn.mvMatrixUniform,!1,bn);var n=sn.create();gn.toInverseMat3(bn,n),sn.transpose(n),Pn.uniformMatrix3fv(Sn.nMatrixUniform,!1,n)}function T(n){p(),Pn.drawElements(Pn.TRIANGLES,n.index.numElements,Pn.UNSIGNED_SHORT,0)}function A(){Pn.uniform1i(Sn.useLightingUniform,!0)}function M(n,t,e){Pn.uniform3f(Sn.ambientColorUniform,n,t,e)}function L(n,t,e){Pn.uniform3f(Sn.pointLightingColorUniform,n,t,e)}function y(){return"\nprecision highp float;\nvarying vec2 vTextureCoord;\nvarying vec3 vLightWeighting;\nuniform sampler2D uSampler;\nvoid main(void) {\nvec4 textureColor = texture2D(uSampler, vec2(vTextureCoord.s, vTextureCoord.t));\ngl_FragColor = vec4(textureColor.rgb * vLightWeighting, textureColor.a);\n}"}function R(){return"\nattribute vec3 aVertexPosition;\nattribute vec3 aVertexNormal;\nattribute vec2 aTextureCoord;\nuniform mat4 uMVMatrix;\nuniform mat4 uPMatrix;\nuniform mat3 uNMatrix;\nuniform vec3 uAmbientColor;\nuniform vec3 uPointLightingLocation;\nuniform vec3 uPointLightingColor;\nuniform bool uUseLighting;\nvarying vec2 vTextureCoord;\nvarying vec3 vLightWeighting;\nuniform bool uUseDistanceLightWeighting;\nvoid main(void) {\nfloat distanceLightWeighting = 1.0;\nvec4 mvPosition = uMVMatrix * vec4(aVertexPosition, 1.0);\ngl_Position = uPMatrix * mvPosition;\nvTextureCoord = aTextureCoord;\nvec3 lightDirection = normalize(uPointLightingLocation - mvPosition.xyz);\nvec3 transformedNormal = uNMatrix * aVertexNormal;\nfloat directionalLightWeighting = max(dot(transformedNormal, lightDirection), 0.0);\nfloat mvDistance = length(uPointLightingLocation - mvPosition.xyz);\nif (uUseDistanceLightWeighting) {\ndistanceLightWeighting = pow(0.99, mvDistance*2.0);\n}\nvLightWeighting = uAmbientColor + uPointLightingColor * distanceLightWeighting;\n}"}function U(){N(0,0),_(),C()}function C(){An.beacon={x:0,z:-50,rota4ionY:0}}function N(n,t){void 0===An.blocks[n]&&(An.blocks[n]={}),An.blocks[n][t]={trees:[]};for(e=0;e<dn;e++)An.blocks[n][t].trees.push({x:hn()*Fn-Fn/2,z:hn()*Fn-Fn/2,rotationY:hn()*ln*2,height:60+60*hn()});for(var e=0;e<pn;e++)An.monsters.push({x:n*Fn+hn()*Fn-Fn/2,z:t*Fn+hn()*Fn-Fn/2})}function D(){var t=n(vn(wn.x/Fn)),e=n(vn(wn.z/Fn));return[{x:t,z:e},{x:t-1,z:e-1},{x:t,z:e-1},{x:t+1,z:e-1},{x:t+1,z:e},{x:t+1,z:e+1},{x:t,z:e+1},{x:t-1,z:e+1},{x:t-1,z:e}]}function _(){D().forEach(function(n){var t=n.x,e=n.z;void 0===An.blocks[t]&&(An.blocks[t]={}),void 0===An.blocks[t][e]&&N(t,e)})}function P(){Cn={straightMovement:0,sideMovement:0,isClimbing:!1,lasers:[]}}function S(){Cn.lasers.push({x:wn.x+Math.sin(wn.yaw+ln/4)*Un,y:wn.y-Math.tan(wn.pitch)*Un-.2*Ln,z:wn.z+Math.cos(wn.yaw+ln/4)*Un,pitch:wn.pitch,yaw:wn.yaw,expire:new Date/1e3+Rn})}function w(){var n=yn*Bn/1e3*-1;Cn.lasers.forEach(function(t){t.z+=Math.cos(t.yaw)*n,t.y+=Math.tan(t.pitch)*n*-1,t.x+=Math.sin(t.yaw)*n})}function I(){O("menu")}function z(){mn&&mn.close(),mn=new AudioContext,Nn.menu.gain=mn.createGain(),Nn.play.gain=mn.createGain(),Nn.menu.gain.connect(mn.destination),Nn.play.gain.connect(mn.destination),F()}function F(){Nn.menu.gain.gain.value=0,Nn.play.gain.gain.value=0}function O(n){var t=0,e=[];z(),Nn[n].gain.gain.value=.2;for(var i=0;i<50;i++)e=e.concat(Nn[n].notes);e.forEach(function(e,i){var r=e[0],o=e[1],a=e[2];B(Nn[n].gain,r,t,o),t+=a})}function B(n,t,e,i){var r=mn.createOscillator();r.connect(n),r.frequency.value=t,r.type="square",r.start(mn.currentTime+e),r.stop(mn.currentTime+e+i)}function k(){_n.width=window.innerWidth,_n.height=window.innerHeight,a(y(),R()),Y(function(){cn()}),W()}function W(){zn.innerHTML="[EVIL WOOD]<br><br>YOU ARE LOST IN AN EVIL FOREST<br>LET THE NORTH STAR GUIDE YOU<br>CLIMB TREES TO SEE THE SKY<br>FIND THE RED BEACON TO ESCAPE<br>BEWARE THE DARK SOULS<br><br>"+Dn+"<br><br>CLICK SCREEN TO START"}function G(){zn.innerHTML="[PAUSED]<br><br>"+Dn+"<br>CLICK SCREEN TO CONTINUE"}function V(){zn.innerHTML=""}function Y(n){In={tree:{encoding:"data:image/gif;base64,R0lGODlhEAAQAPcAAAAAAP///0RIOz9AOFBRR0REOlNTS1dWPVZVQ0RDNElIOkpJO0pJPFFQQ1RTSFZVTEE/MVFPP1NRQlRSQ1dVRkZDMktINj89MUNBNlBOQUtJPVJQQ1pYS1BNPVFOQF1aS11bUVRQPlFNPVxYR0A+NVpXS15bT2ZjV0pIQEhBJ1hROElEMVtWRF5ZR0pGOFhURlBNQkdFPkA4Hk5GLUA6J0Q+K0hCLjw3J0ZBMVxWQ1NOPkhENz88MlRQQ0lBKkY/KlhPN05IODg0KVNOP1RPQGNdTEA8MUZCNkRANUZCN1lVSV5aTkZDO0c+J0I6JzEsH05GMzYxJE5HNkU/MGhfSVpTQk9JOltUQ2JbSUpFOEZBNVdSRkhEOlpVSUM3HD4zGkg+J0Y8JkxCLEpBLEU9Kz43J0E6Ki4pHktDMTo0JkI7LDs1KEA6LFVNO0dBM1tTQklDNVxUQ1BKPEA7MFZQQlZQQ0Y5Hz0zHz41I1BFLkg+KktCL1lPOkc/L1lQPkY/MTw2KlFJOUdAMj03K0tENlhQQFpSQkZANFhRQ1dQQkM+NFROQjYmCTcpEEAzGzwxHDYsGj4zHzYtHUM5JjMrHU1CLSokGU9EMDoyJDszJU1DMUc+LTcwIz01J1RJNkI6K0Q8LVpQPTUvJFNKOUc/MUE6LUlBM0Y/MlFJOlRMPVVNP1NMP1dQQ0ZBOD0xHSggEzUrGjowHycgFT0zIj40Iz40JEg9K0M5KUA3KEE4KUI5KkxCMlBGNUA4K1FHNz84LFRLPEI7Lz85LzImFT8yH0c5JDMpGkg7J0U5JzUsHkI3JkE2Jkc7KjEpHT81Jko+LUY7KzQsIEg9LVFFNEY9L1ZLOklAMzkyKExDNk9IPk5IPzMnF0I0IUAzITcsHTMpG0s8KEM2JEU4JkE1JTQrH0c7K1JFNDoxJUk/MjstHDkuIT4zJkc8LlFGOCkdDyccEDUsIjYtIzszKlFGOjcnFzgtIjgoGTszLDYmGgAAAAAAAAAAAAAAAAAAAAAAAAAAACwAAAAAEAAQAAAI/wAX6OgUzVwhF4qYWMn07VKVBgrAVJJGj5mUAg/GgJNzhJcgHkRUHFN3SxkUVSb4FMtVB52yalgQ7OozIdK0dqg8qKkVihsyPzl+VOjQAw8kJFpq2GgzytUwNuRS0BCQoNcdOO+++LCwphksOLLsGAMkZlYiYJS8SIoy7lyGInIYPWJgC9QGT38aOcIRq5QEKm9k6BlwBg2LKfdohSHxZE8LESsOALFWj9AQCAQi5FlkYEmWGyE0zXCGTZOvFyVMNdEFgk65Kx/wdWNAYdIzbdnseUtiKJw4DlvYLTvEihimGHOgjTuVKh2nVvEErQuGYtsmGK/K4PolzJ0oLpbIyCQzgiFZHERpnAy6FgWekhFuPgXZcYHavC4azAQiJeTXqhMOBAQAOw=="},ground:{encoding:"data:image/gif;base64,R0lGODlhEAAQAPcAAAAAAP///2lkZSgmJ29tbjExMlhZXjM0NS8xMj1BQjM3Ny4vLyYsKyMmJVZbWScsKVdcWSwxLCYoJklMSSguJjg9NjM9LjI0MTM4MDM2MR4fHURFQz9GNzM3Li46HkJFPi48GTA+GiEnGDI3Ki8zKTs/NTg6NTY4MzM8Iz9ILzM6JzxCMjU4MDdDITQ6KSowHlJbPywwJERKODEzLTM1Lzo8NkNEQSo4Cio0EjxKGyoyFx0iEkJLLi4xJ0tQQE1QRjtGHjZAHURLMSQpFiAkFBETCxodETE2IysuIjs+Mi8xKRscGDk7M1RWTltcWDE4GTA2HTAzJjI1KDU3Lj0/NkpSKyouGzs/Kzk9Kjg6MEhKQDU5JDk8LCwuIyktFEJHKS0wHCEjFjU4Ji8xJB8gGkhKPVBSRTU6GDE0HiIkFkJFMCwuIDs9LkFDNTc4MSotFDc7Gzc6IldbOjM1Ij5AL0BCMjIzKkVGPklKQltcUywuFSUnEy8xGTM1IVVXPjQ1Kz9ANTQ2GCkqGCkqG0dIODo7JD0+JzY3Izk6JjY3JFRVOywsGjk5JzIyJS8vI0tLOEBAMjg4LSkpIUlJPzo6MyoqJlxcVFNTTCkpJklJRUVFQSQkIktLSCIhETY1I0hHNEE/KEdFLkNCNUA/M1dWSygmEzg1GzUzIUA+LUxKOU1MQk5NREA+LyUkHS0sJUpJQj47KktINzEvJFFOPTs5LV5bSTw6L0ZEN1RSRVRSR1xaTj08Nk5HIj88LC0rITs5L1hVR2FeUFxaUDQzLklIQzIuHTc0KC0rIjY0K15bTlhVSTUzLElHQE9NRjItHDw3Jz06MGplVEZDOWZjWTEsHTArHVdONkVAMVFLOjs3LDQxKFhTRTk2LU5KPk5LQnBuaC4nFkA7LmBcUlFJOD85LGBbUFVSS2BaThsaGG5qYkM6Ky8pH0hBNUNAO0tJRlRSTzcsHUY4JTctID86M2BbVD06NkpGQVBMSDYxLwAAAAAAAAAAAAAAAAAAAAAAAAAAACwAAAAAEAAQAAAI/wDXUAghhAuNA12iUIHGTdo4a9ES1OiAIUODB0kiMPAB6ZAWAxDy6JpWiQyaQvgwzXkCJ44KB2WwBcN1zMgZXvGeBXqjCE+PPsVGMWMyJlEbG8tkDYoxwR0xZI5mDFMmZpIZDiNu0WFjgcW8VSVOOLnERMGRLzBWsLliRUSaKRU4bViioYgJAnJugIFS6hQjVzOQkEDma5MEN7MQ1WnBQw0le9mIvLBFrpqxXa/ubeNjKJS8cKyUhPECKJcwVY9qxfpkChw1T7R+rduDpcmGRr3OJfPTTdsfVKngqZM0RE+nRa3qtYNF7504UtnYRbpjZ4cOKQguLEDX7Fs6Qls+uCSQQQMEjgGasnC7BsySOVBAcqTwICgIigKZflDxVs6ZKAFVBAQAOw=="},leaves:{encoding:"data:image/gif;base64,R0lGODlhEAAQAPcAAAAAAP///09gF0tXFVNgGUFKF1FcFkBID1hiFUhRE0ZOC0xUD01VEkdNE19oGk9WF1VdDkFGCzc7CjtAC1RbEGFpEzM3ClRaEzg8DU5TFVFWF1NZHEFFFmpwJD9DCjs+C1NYEVNXEk1SEj9CD0pOFnl+JVldHE9TG1daEVteE05REUlMEERHD1xfFUdJE2ltHVRWF0lLFVlcGl9iHFNVG2BjIFZYHVFTH0BBCT0+CT0+DVJUEkhJEFxdFUlKEUxNE11eGFtcGWprHy8wEDQ1ElpbIF9gJSEhAjAwCTg4C0pKD0VFDlNTEUlJDzs7DVdWFFVVFEREFElJFlVVGl1dHVpaHEtLGC0sBUxKElNRFkA/EUJBElBPFkFAEmRiHD08EVNRGUtJF1pYHEpJGUxLGmBeITY0CTAuCUE+DUpHEUZEE1JPF0hGFkhFFkdFF2RhImViI0VDGEZEGlNRIiEfAzMwCExHEDUyCz47Djs4DjIvDFNOFTw5D0xIFURAFE9LGExIF01JGEdDFmRfIFpVHVhTHTUxBzUxCkA7DUI9D0dCEUZBEkE8EUpFFEdCFElEFUE9E1BLGEM+FFNOHDw4Fz44DTs2DjItDElCE0E7E1lRHE9IGUU/F0I9Fjs2FFRNHVJMHU9JHEZBGldRIiUgATkyC0pCDzcxCy4pCiUhCC8qCzEsDFJJGFtSHVdOHE1GHElCG15WI1VNICwmCUM7EVlPGjQuEUtDGTkzEzEsEVNKIGJYJllQIzIqCkE4EUA4FEY9GE1EHEpBGzs0FlVLIFNJIVFIIicgBzMrDDsyEUtAF0tBHVZNKjYtED81E1RHHkc8GkU7G0k/HyAZBiUeCUw+FzMqEE1AGUQ5GkI4HDsyGUk7FjgtEkQ3GEQ5HDwwFCYeDS4lEE9AHUw+HUk9I2BSMjwuEzwvFkk6G08/H0s8IldGK1tILDouHVRCKUo4IVE/LDYoG0ExJQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACwAAAAAEAAQAAAI/wBvZIDxI5WFBhgc1GBgwogBAQTwOIlz7pAHJEmW8CBDwgWHARvYaJjhZZA4c6UwRaqyIoeWObFGoRBSwRGrWug0AXkCZQcIWLw2MXkh40sQU48mZdkTJhQVN8DAiCEErcuCP+s4pXnGbhcVLsxoFCLWRpQOG+UYfXgFb5ydFG+KCZIkDFs4da6q+Ukgy1kzR33MXEF16lg7d+mUoYkAiBY1PXzItUr0LV60MNI8SUiCK9MvLIvkZSvV7d01HKC8WTuzxVgwNchyrZrVy5AiX6Rscet0okifQ9OG3VJy51KlZOC0hZgyqkUQRFfgfFLRRNWjNcu29RBRpkSQBxCiHCQYAinGmEZ1jljygaCDLkp5iBQYYUUOHVWqJrBQQOFCICkjBAQAOw=="},red:{encoding:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVR42mP8z8DwHwAFBQIAX8jx0gAAAABJRU5ErkJggg=="},shadow:{encoding:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mNkqAcAAIUAgUW0RjgAAAAASUVORK5CYII="},monster:{encoding:"data:image/gif;base64,R0lGODlhEAAQAPcAAAAAAP///186h2Y/j187iFo4hlU1f2A8jlg3glY2flg4gWI/j148iVk4h1Y2glQ1f1AyeFc3g1U2gVI0fFk5hlc4hFQ2f1s6h1g4g1w7iVk6hl49jFE1eUMpaUUrbUMqak4xeVE0f1I0f1AzfU8ye0swdkwwdlI0fkwxd0swdEgucFY3hFI1gE8ze0wxdkowc1k5iFU3g1A0fFc5hlQ3glI2f1M2f1Q3gVA0elA0eVc6hVY5g1Q4gVU4gUAoakUscUYscU8yf0gudEUsb0MrbD4oZU0yfU4yfEgvdEUtb0IrakwyekwxeEgvc0QsbFE1gU80flA0fk4zfE0yeUsxd0kwdUowdUYucE4ze0wyeEoxdkQtbE80fE4zekkwckIsaVY5hlI2gE40e0wzeEgwcVI3gVE2fksydVQ4gjokYj0nZz4oaTgkXz4oZkUtcUQsb0ErbEIrbEAqakwyfUgvdUAqaUIsbUMsbUgwdkkwdkUucUQtbkkxd0Yvck41f000fUwze0syeEYvcUUub041fkszekkxdUw0e000e0kydk00ek41e0w0eUozdkw0dzUhXjIfWDgkYDwnZjomZD4paz8qbDomYj8qakUvdUYvdUAraz0pZkUvdEQuckEsbUcwdkMucUItbj8raUkyeUYwdEQvckItbUAsa001gEoze0sze0gyeEkyeEcxdkYwc0QvcU01fkozeUkyd0YwckQvcE02f0ozeEUwcUs0ek83f0s0eTIgXTckZDglZTckYTwoaDknZTclYEArbz4qbDsoZkItcTwpZz8razooZEIuckEtb0AsbD4raUs0fkUwdUQwdD8saz0raD4raEcyeEQwc0MvcUIub0MvcEs1fEUxc0QxcjQkXzUkXzspaTQkXTkoZj0razopZkAtbzopZUQyc0Y0dSkbUTQlXgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACwAAAAAEAAQAAAI/wAJJJgSQxmxQmBOgLCQ5ZkzKCsgmJDwZpuxG6ps2UljKxuRHmKaTAjRqtygB6uooSrFbBIHL90+MbpWjVQXIy0cwZp27lghaGOQWANHi04UGFTuXHDSBk8mU3cMsRKWBMMBDVYEEDBVgcUoMm3UcMJEggETYGdKwNnly5W4LBGWFeNhIAwvSdLMfQvWQUgyQDM05VLyYQmlWIg8vdKWw4AsQlKA2JhFo1OVFi4qOJjDZwu0PjbicKlhxpcHBYKONChAY5g1RUNOhUv0hU2dIleQbUITpBmtRT+eUCPnLZQuFQh2jNMi4hAoQ7VG6PjVB5soSy8W7Im0AUujMn4yZCTx0SIVLjnRUgxow03OpT951vR6pGdUp1sU3MhAAQlHoG6VBAQAOw=="},orange:{encoding:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVR42mP8v57hPwAHEgKv3MuCuAAAAABJRU5ErkJggg=="}};var t=0,e=0;for(var i in In)!function(){e++;var r=In[i],o=r.glTexture=Pn.createTexture(),a=r.image=new Image;a.onload=function(){b(o,a),++t>=e&&n()},a.src=r.encoding}()}function H(){var n=An.beacon;i(),f(n.x,6,n.z),d(On.cube,In.red.glTexture,!1),T(On.cube),r(),i(),f(n.x,-1.99,n.z),d(On.cube,In.shadow.glTexture,!0),T(On.cube),r();var t=fn.create([n.x-wn.x,0,n.z-wn.z]);fn.normalize(t),i(),f(wn.x,140,wn.z),f(100*t[0],0,100*t[2]),d(On.cube,In.orange.glTexture,!1),T(On.cube),r()}function X(){An.monsters.forEach(function(n){i(),f(n.x,0,n.z),d(On.cube,In.monster.glTexture,!0),T(On.cube),r(),i(),f(n.x,2,n.z),d(On.cube,In.monster.glTexture,!0),T(On.cube),r(),i(),f(n.x,4,n.z),d(On.cube,In.monster.glTexture,!0),T(On.cube),r(),i(),f(n.x,6,n.z),d(On.cube,In.monster.glTexture,!0),T(On.cube),r()})}function q(n,t){i(),f(n*Fn,-1.1,t*Fn),d(On.plane,In.ground.glTexture,!0),T(On.plane),r()}function K(n,t){for(var e=An.blocks[n][t].trees,o=0;o<e.length;o++){for(var a=e[o],u=n*Fn+a.x,c=t*Fn+a.z,m=0;m<a.height/4;m++){var l=4*m;i(),f(u,l,c),s(a.rotationY,0,1,0),g(2,2,2),d(On.cube,In.tree.glTexture,!0),T(On.cube),r()}Tn.forEach(function(n){i(),f(u+8*n[0],l+8*n[2],c+8*n[1]),g(4,4,4),d(On.cube,In.leaves.glTexture,!0),T(On.cube),r()})}}function j(){D().forEach(function(n){var t=n.x,e=n.z;q(t,e),K(t,e)})}function J(){if(0!==Cn.straightMovement){t=(n=1===Cn.straightMovement?-1:1)*Mn*Bn/1e3;Cn.isClimbing?(wn.y+=-1*t,wn.y<Ln&&(wn.y=Ln,Cn.isClimbing=!1)):(wn.z+=t*Math.cos(wn.yaw),wn.x+=t*Math.sin(wn.yaw))}if(0!==Cn.sideMovement){var n=1===Cn.sideMovement?1:-1,t=n*Mn*Bn/1e3;wn.z+=t*Math.cos(wn.yaw+Math.PI/2),wn.x+=t*Math.sin(wn.yaw+Math.PI/2)}}function Q(){Cn.lasers.forEach(function(n){i(),f(n.x,n.y,n.z),s(n.yaw,0,1,0),s(n.pitch,1,0,0),g(.2,.2,5),d(On.cube,In.orange.glTexture,!1),T(On.cube),r()})}function Z(){e(),u(45,.1,150),c(),A(),M(0,0,0),L(.9,.9,.9),s(-wn.pitch,1,0,0),s(-wn.yaw,0,1,0),f(-wn.x,-wn.y,-wn.z),j(),H(),X(),Q()}function $(n){switch(n.which||n.keyCode){case 65:"playing"===Wn&&(Cn.sideMovement=-1);break;case 87:"playing"===Wn&&(Cn.straightMovement=1);break;case 68:"playing"===Wn&&(Cn.sideMovement=1);break;case 83:"playing"===Wn&&(Cn.straightMovement=-1);break;case 32:"playing"===Wn&&(Cn.straightMovement=1,Cn.isClimbing=!0)}}function nn(n){switch(n.which||n.keyCode){case 65:Cn.sideMovement=0;break;case 87:Cn.straightMovement=0;break;case 68:Cn.sideMovement=0;break;case 83:case 32:Cn.straightMovement=0}}function tn(n){en()&&(wn.pitch+=n.movementY*ln*.001*-1,wn.pitch>ln/2&&(wn.pitch=ln/2),wn.pitch<-1*ln/2&&(wn.pitch=-1*ln/2),wn.yaw+=n.movementX*ln*.001*-1)}function en(){return document.pointerLockElement===_n}function rn(n){"menu"===Wn||"paused"===Wn?on():"playing"===Wn&&S()}function on(){Wn="playing",_n.requestPointerLock(),V(),O("play")}function an(){Wn="paused",O("menu"),G()}function un(){document.addEventListener("keydown",function(n){$(n)},!1),document.addEventListener("keyup",function(n){nn(n)},!1),document.addEventListener("mousemove",function(n){tn(n)},!1),document.addEventListener("click",function(n){rn(n)},!1),document.addEventListener("pointerlockchange",function(n){en()||"playing"!==Wn||an()},!1)}function cn(){var n=(new Date).getTime();0!==kn&&(Bn=n-kn),J(),w(),_(),Z(),kn=n,window.requestAnimationFrame(cn)}glMatrixArrayType="undefined"!=typeof Float32Array?Float32Array:"undefined"!=typeof WebGLFloatArray?WebGLFloatArray:Array;var fn={};fn.create=function(n){var t=new glMatrixArrayType(3);return n&&(t[0]=n[0],t[1]=n[1],t[2]=n[2]),t},fn.scale=function(n,t,e){return e&&n!=e?(e[0]=n[0]*t,e[1]=n[1]*t,e[2]=n[2]*t,e):(n[0]*=t,n[1]*=t,n[2]*=t,n)},fn.normalize=function(n,t){t||(t=n);var e=n[0],i=n[1],r=n[2],o=Math.sqrt(e*e+i*i+r*r);return o?1==o?(t[0]=e,t[1]=i,t[2]=r,t):(o=1/o,t[0]=e*o,t[1]=i*o,t[2]=r*o,t):(t[0]=0,t[1]=0,t[2]=0,t)},fn.direction=function(n,t,e){e||(e=n);var i=n[0]-t[0],r=n[1]-t[1];return n=n[2]-t[2],(t=Math.sqrt(i*i+r*r+n*n))?(t=1/t,e[0]=i*t,e[1]=r*t,e[2]=n*t,e):(e[0]=0,e[1]=0,e[2]=0,e)};var sn={};sn.create=function(n){var t=new glMatrixArrayType(9);return n&&(t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t[9]=n[9]),t},sn.transpose=function(n,t){if(!t||n==t){var e=n[1],i=n[2],r=n[5];return n[1]=n[3],n[2]=n[6],n[3]=e,n[5]=n[7],n[6]=i,n[7]=r,n}return t[0]=n[0],t[1]=n[3],t[2]=n[6],t[3]=n[1],t[4]=n[4],t[5]=n[7],t[6]=n[2],t[7]=n[5],t[8]=n[8],t};var gn={};gn.set=function(n,t){return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],t},gn.identity=function(n){return n[0]=1,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=1,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=1,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n},gn.create=function(n){var t=new glMatrixArrayType(16);return n&&(t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15]),t},gn.identity=function(n){return n[0]=1,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=1,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=1,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n},gn.toMat3=function(n,t){return t||(t=sn.create()),t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[4],t[4]=n[5],t[5]=n[6],t[6]=n[8],t[7]=n[9],t[8]=n[10],t},gn.toInverseMat3=function(n,t){var e=n[0],i=n[1],r=n[2],o=n[4],a=n[5],u=n[6],c=n[8],f=n[9],s=n[10],g=s*a-u*f,m=-s*o+u*c,l=f*o-a*c,v=e*g+i*m+r*l;return v?(v=1/v,t||(t=sn.create()),t[0]=g*v,t[1]=(-s*i+r*f)*v,t[2]=(u*i-r*a)*v,t[3]=m*v,t[4]=(s*e-r*c)*v,t[5]=(-u*e+r*o)*v,t[6]=l*v,t[7]=(-f*e+i*c)*v,t[8]=(a*e-i*o)*v,t):null},gn.multiply=function(n,t,e){e||(e=n);var i=n[0],r=n[1],o=n[2],a=n[3],u=n[4],c=n[5],f=n[6],s=n[7],g=n[8],m=n[9],l=n[10],v=n[11],h=n[12],b=n[13],E=n[14];n=n[15];var x=t[0],d=t[1],p=t[2],T=t[3],A=t[4],M=t[5],L=t[6],y=t[7],R=t[8],U=t[9],C=t[10],N=t[11],D=t[12],_=t[13],P=t[14];return t=t[15],e[0]=x*i+d*u+p*g+T*h,e[1]=x*r+d*c+p*m+T*b,e[2]=x*o+d*f+p*l+T*E,e[3]=x*a+d*s+p*v+T*n,e[4]=A*i+M*u+L*g+y*h,e[5]=A*r+M*c+L*m+y*b,e[6]=A*o+M*f+L*l+y*E,e[7]=A*a+M*s+L*v+y*n,e[8]=R*i+U*u+C*g+N*h,e[9]=R*r+U*c+C*m+N*b,e[10]=R*o+U*f+C*l+N*E,e[11]=R*a+U*s+C*v+N*n,e[12]=D*i+_*u+P*g+t*h,e[13]=D*r+_*c+P*m+t*b,e[14]=D*o+_*f+P*l+t*E,e[15]=D*a+_*s+P*v+t*n,e},gn.translate=function(n,t,e){var i=t[0],r=t[1];if(t=t[2],!e||n==e)return n[12]=n[0]*i+n[4]*r+n[8]*t+n[12],n[13]=n[1]*i+n[5]*r+n[9]*t+n[13],n[14]=n[2]*i+n[6]*r+n[10]*t+n[14],n[15]=n[3]*i+n[7]*r+n[11]*t+n[15],n;var o=n[0],a=n[1],u=n[2],c=n[3],f=n[4],s=n[5],g=n[6],m=n[7],l=n[8],v=n[9],h=n[10],b=n[11];return e[0]=o,e[1]=a,e[2]=u,e[3]=c,e[4]=f,e[5]=s,e[6]=g,e[7]=m,e[8]=l,e[9]=v,e[10]=h,e[11]=b,e[12]=o*i+f*r+l*t+n[12],e[13]=a*i+s*r+v*t+n[13],e[14]=u*i+g*r+h*t+n[14],e[15]=c*i+m*r+b*t+n[15],e},gn.scale=function(n,t,e){var i=t[0],r=t[1];return t=t[2],e&&n!=e?(e[0]=n[0]*i,e[1]=n[1]*i,e[2]=n[2]*i,e[3]=n[3]*i,e[4]=n[4]*r,e[5]=n[5]*r,e[6]=n[6]*r,e[7]=n[7]*r,e[8]=n[8]*t,e[9]=n[9]*t,e[10]=n[10]*t,e[11]=n[11]*t,e[12]=n[12],e[13]=n[13],e[14]=n[14],e[15]=n[15],e):(n[0]*=i,n[1]*=i,n[2]*=i,n[3]*=i,n[4]*=r,n[5]*=r,n[6]*=r,n[7]*=r,n[8]*=t,n[9]*=t,n[10]*=t,n[11]*=t,n)},gn.rotate=function(n,t,e,i){var r=e[0],o=e[1];e=e[2];var a=Math.sqrt(r*r+o*o+e*e);if(!a)return null;1!=a&&(r*=a=1/a,o*=a,e*=a);var u=Math.sin(t),c=Math.cos(t),f=1-c;t=n[0],a=n[1];var s=n[2],g=n[3],m=n[4],l=n[5],v=n[6],h=n[7],b=n[8],E=n[9],x=n[10],d=n[11],p=r*r*f+c,T=o*r*f+e*u,A=e*r*f-o*u,M=r*o*f-e*u,L=o*o*f+c,y=e*o*f+r*u,R=r*e*f+o*u;return r=o*e*f-r*u,o=e*e*f+c,i?n!=i&&(i[12]=n[12],i[13]=n[13],i[14]=n[14],i[15]=n[15]):i=n,i[0]=t*p+m*T+b*A,i[1]=a*p+l*T+E*A,i[2]=s*p+v*T+x*A,i[3]=g*p+h*T+d*A,i[4]=t*M+m*L+b*y,i[5]=a*M+l*L+E*y,i[6]=s*M+v*L+x*y,i[7]=g*M+h*L+d*y,i[8]=t*R+m*r+b*o,i[9]=a*R+l*r+E*o,i[10]=s*R+v*r+x*o,i[11]=g*R+h*r+d*o,i},gn.frustum=function(n,t,e,i,r,o,a){a||(a=gn.create());var u=t-n,c=i-e,f=o-r;return a[0]=2*r/u,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=2*r/c,a[6]=0,a[7]=0,a[8]=(t+n)/u,a[9]=(i+e)/c,a[10]=-(o+r)/f,a[11]=-1,a[12]=0,a[13]=0,a[14]=-o*r*2/f,a[15]=0,a},gn.perspective=function(n,t,e,i,r){return n=e*Math.tan(n*Math.PI/360),t*=n,gn.frustum(-t,t,-n,n,e,i,r)};var mn,ln=Math.PI,vn=Math.round,hn=Math.random,bn=gn.create(),En=gn.create(),xn=[],dn=20,pn=1,Tn=[[-1,-2,-2],[0,-2,-2],[1,-2,-2],[-2,-1,-2],[-1,-1,-1],[0,-1,-1],[1,-1,-1],[2,-1,-2],[-2,0,-2],[-1,0,-1],[1,0,-1],[2,0,-2],[-2,1,-2],[-1,1,-1],[0,1,-1],[1,1,-1],[2,1,-2],[-1,2,-2],[0,2,-2],[1,2,-2],[0,0,0]],An={blocks:{},beacon:{},monsters:[]},Mn=40,Ln=6,yn=200,Rn=1,Un=2,Cn={},Nn={menu:{notes:[[61.74,.13,.15],[61.74,.13,.3],[61.74,.13,.3],[61.74,.13,.15],[61.74,.13,.15],[61.74,.13,.15],[61.74,.13,.3],[61.74,.13,.3],[61.74,.13,.6],[51.91,.13,.15],[51.91,.13,.3],[51.91,.13,.3],[51.91,.13,.15],[51.91,.13,.15],[51.91,.13,.15],[51.91,.13,.3],[51.91,.13,.3],[51.91,.13,.6],[41.2,.13,.15],[41.2,.13,.3],[41.2,.13,.3],[41.2,.13,.15],[41.2,.13,.15],[41.2,.13,.15],[41.2,.13,.3],[41.2,.13,.3],[41.2,.13,.6],[61.74,.13,.15],[61.74,.13,.3],[61.74,.13,.3],[61.74,.13,.15],[61.74,.13,.15],[61.74,.13,.15],[61.74,.13,.3],[61.74,.13,.3],[61.74,.13,.6]]},play:{notes:[[65.41,.3,.5],[65.41,.3,.5],[65.41,.15,.25],[69.3,.15,.25],[65.41,.3,.5],[65.41,.15,.25],[69.3,.15,.25],[65.41,.15,.25],[61.74,.15,.25],[65.41,.3,1]]}},Dn="[WASD]&nbsp; MOVE AROUND&nbsp;&nbsp;&nbsp;<br>[CLICK] SHOOT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>[SPACE] CLIMB TREE &nbsp;&nbsp;&nbsp;<br>[ESC]&nbsp;&nbsp; PAUSE &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>",_n=document.getElementById("scene"),Pn=_n.getContext("webgl"),Sn=Pn.createProgram(),wn={x:0,y:Ln,z:0,pitch:0,yaw:0},In={},zn=document.getElementById("c"),Fn=100,On={cube:{position:E([-1,-1,1,1,-1,1,1,1,1,-1,1,1,-1,-1,-1,-1,1,-1,1,1,-1,1,-1,-1,-1,1,-1,-1,1,1,1,1,1,1,1,-1,-1,-1,-1,1,-1,-1,1,-1,1,-1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,-1,1,-1,-1,-1,-1,-1,1,-1,1,1,-1,1,-1]),normal:E([0,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0]),texture:E([0,0,1,0,1,1,0,1,1,0,1,1,0,1,0,0,0,1,0,0,1,0,1,1,1,1,0,1,0,0,1,0,1,0,1,1,0,1,0,0,0,0,1,0,1,1,0,1]),index:x([0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23])},plane:{position:E([-50,0,-50,-50,0,50,50,0,50,50,0,-50]),normal:E([0,1,0,0,1,0,0,1,0,0,1,0]),texture:E([0,25,0,0,25,0,25,25]),index:x([0,1,2,0,2,3])}},Bn=0,kn=0,Wn="menu";t(),U(),P(),k(),I(),un()}();</script>
</body>
</html>